var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function i(e){e.forEach(t)}function r(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function a(t,n,i){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const i=t.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}(n,i))}function c(e,t){e.appendChild(t)}function s(e,t,n){e.insertBefore(t,n||null)}function d(e){e.parentNode.removeChild(e)}function l(e){return document.createElement(e)}function u(e){return document.createTextNode(e)}function h(){return u(" ")}function m(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function p(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function f(e){return""===e?null:+e}function P(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function _(e,t){e.value=null==t?"":t}function b(e,t,n,i){e.style.setProperty(t,n,i?"important":"")}let y;function S(e){y=e}function g(e){(function(){if(!y)throw new Error("Function called outside component initialization");return y})().$$.on_mount.push(e)}const v=[],E=[],A=[],x=[],w=Promise.resolve();let N=!1;function R(e){A.push(e)}let O=!1;const I=new Set;function T(){if(!O){O=!0;do{for(let e=0;e<v.length;e+=1){const t=v[e];S(t),D(t.$$)}for(S(null),v.length=0;E.length;)E.pop()();for(let e=0;e<A.length;e+=1){const t=A[e];I.has(t)||(I.add(t),t())}A.length=0}while(v.length);for(;x.length;)x.pop()();N=!1,O=!1,I.clear()}}function D(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(R)}}const L=new Set;function U(e,t){-1===e.$$.dirty[0]&&(v.push(e),N||(N=!0,w.then(T)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function M(o,a,c,s,l,u,h=[-1]){const m=y;S(o);const p=o.$$={fragment:null,ctx:null,props:u,update:e,not_equal:l,bound:n(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(m?m.$$.context:[]),callbacks:n(),dirty:h,skip_bound:!1};let f=!1;if(p.ctx=c?c(o,a.props||{},((e,t,...n)=>{const i=n.length?n[0]:t;return p.ctx&&l(p.ctx[e],p.ctx[e]=i)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](i),f&&U(o,e)),t})):[],p.update(),f=!0,i(p.before_update),p.fragment=!!s&&s(p.ctx),a.target){if(a.hydrate){const e=function(e){return Array.from(e.childNodes)}(a.target);p.fragment&&p.fragment.l(e),e.forEach(d)}else p.fragment&&p.fragment.c();a.intro&&((P=o.$$.fragment)&&P.i&&(L.delete(P),P.i(_))),function(e,n,o){const{fragment:a,on_mount:c,on_destroy:s,after_update:d}=e.$$;a&&a.m(n,o),R((()=>{const n=c.map(t).filter(r);s?s.push(...n):i(n),e.$$.on_mount=[]})),d.forEach(R)}(o,a.target,a.anchor),T()}var P,_;S(m)}function C(e){return{enumerable:!0,value:e}}function q(e){return{enumerable:!0,writable:!0,value:e}}let k={},H=()=>!0,$=()=>({}),F=e=>e,W=(e,t,n,i)=>e.apply(n,i)&&t.apply(n,i),z=(e,t,n,[i,r])=>t.call(n,e.call(n,i,r),r),B=(e,t)=>Object.freeze(Object.create(e,t));function Q(e,t,n){return e.reduce(((e,t)=>function(...i){return n(e,t,this,i)}),t)}function Y(e){return B(this,{fn:C(e)})}let J={},V=Y.bind(J),X=e=>V(((t,n)=>!!~e(t,n)&&t)),j={},G=Y.bind(j);function Z(e,t){return t.filter((t=>e.isPrototypeOf(t)))}function K(e,t,...n){let i=Q(Z(j,n).map((e=>e.fn)),H,W),r=Q(Z(J,n).map((e=>e.fn)),F,z);return B(this,{from:C(e),to:C(t),guards:C(i),reducers:C(r)})}let ee={},te={},ne=K.bind(ee),ie=K.bind(te,null);function re(e,t,n){return me(t,e,n,this.immediates)||e}function oe(e){let t=new Map;for(let n of e)t.has(n.from)||t.set(n.from,[]),t.get(n.from).push(n);return t}let ae={enter:F};function ce(...e){let t=Z(ee,e),n=Z(te,e),i={final:C(0===e.length),transitions:C(oe(t))};return n.length&&(i.immediates=C(n),i.enter=C(re)),B(ae,i)}let se={enter(e,t,n){return this.fn.call(t,t.context,n).then((e=>t.send({type:"done",data:e}))).catch((e=>t.send({type:"error",error:e}))),e}},de={enter(e,t,n){if(t.child=fe(this.machine,(e=>{t.onChange(e),t.child==e&&e.machine.state.value.final&&(delete t.child,t.send({type:"done",data:e.context}))}),t.context,n),t.child.machine.state.value.final){let n=t.child.context;return delete t.child,me(t,e,{type:"done",data:n},this.transitions.get("done"))}return e}};function le(e,...t){let n=C(oe(t));return ue.isPrototypeOf(e)?B(de,{machine:C(e),transitions:n}):B(se,{fn:C(e),transitions:n})}let ue={get state(){return{name:this.current,value:this.states[this.current]}}};function he(e,t,n=$){return"string"!=typeof e&&(n=t||$,t=e,e=Object.keys(t)[0]),k._create&&k._create(e,t),B(ue,{context:C(n),current:C(e),states:C(t)})}function me(e,t,n,i){let{context:r}=e;for(let{to:o,guards:a,reducers:c}of i)if(a(r,n)){e.context=c.call(e,r,n);let i=t.original||t,a=B(i,{current:C(o),original:{value:i}});return a.state.value.enter(a,e,n)}}let pe={send(e){this.machine=function(e,t){let n=t.type||t,{machine:i}=e,{value:r}=i.state;return r.transitions.has(n)&&me(e,i,t,r.transitions.get(n))||i}(this,e),this.onChange(this)}};function fe(e,t,n,i){let r=Object.create(pe,{machine:q(e),context:q(e.context(n,i)),onChange:C(t)});return r.send=r.send.bind(r),r.machine=r.machine.state.value.enter(r.machine,r,i),r}function Pe(e,t){throw new Error(`Cannot transition from ${e} to unknown state: ${t}`)}k._create=function(e,t){if(!(e in t))throw new Error(`Initial state [${e}] is not a known state.`);for(let e in t){let n=t[e];for(let[,i]of n.transitions)for(let{to:n}of i)n in t||Pe(e,n)}};const{fromCharCode:_e}=String,be=e=>e.charCodeAt(0);function ye(e,t){const n=new Uint8Array(t.data);return e.result=[],e.header=n,e.slot=n[5],e.processedBytes=0,e.bytesToProcess=n[8]+256*n[9],console.log(`Loading from slot: ${e.slot} - Expecting ${e.bytesToProcess} bytes (header: ${e.header})`),e}function Se(e,t){const n=new Uint8Array(t.data);return!!n&&(10===n.byteLength&&(243===n[0]&&(15===n[1]&&(171===n[2]&&(202===n[3]&&(1===n[4]&&(0===n[6]&&0===n[7])))))))}function ge(e,t){const n=new Uint8Array(t.data);return e.result.push(n),e.processedBytes+=n.byteLength,e}function ve(e){return e.processedBytes>=e.bytesToProcess}async function Ee(e){console.log("sendLoadRequest",e.port,"patchNumber",e.patchNumber);const t=new Uint8Array([243,15,171,202,0,e.patchNumber,0,0,0,0]);return e.port.send(t),!0}const Ae=he({idle:ce(ie("getHeader",X(Ee))),getHeader:ce(ne("data","header",G(Se))),header:ce(ie("read",V(ye))),read:ce(ie("finished",G(ve)),ne("data","read",V(ge))),finished:ce()},(e=>({...e})));const xe=he({idle:ce(ie("setHeader",V((e=>{const t=new Uint8Array(e.patch);return{...e,processedBytes:0,bytesToProcess:t.byteLength,data:t,currentIteration:0}})))),setHeader:ce(ie("write",X((async function(e){console.log("sendWriteRequest",e.port,"patchNumber",e.patchNumber);let t=new ArrayBuffer(4);new DataView(t).setUint32(0,e.bytesToProcess,!0);const n=new Uint8Array(t),i=new Uint8Array([243,15,171,202,1,e.patchNumber,0,0,n[0],n[1]]);return console.log("sending buffer",i,"ctx.bytesToProcess",e.bytesToProcess,"len.byteLength",n.byteLength,"len",n),e.port.send(i),!0})))),getDataFromPatch:ce(ie("write",V((e=>({...e}))))),write:ce(ie("finished",G(ve)),ie("getDataFromPatch",X((async function(e){const t=64*e.currentIteration,n=t+64,i=e.data.slice(t,n);return e.port.send(i),e.currentIteration++,e.processedBytes+=i.byteLength,e})))),finished:ce()},(e=>({...e}))),we=he({idle:ce(ie("sendHeader",V((e=>(e.patchNumber=0,e.bank=[],{...e}))))),sendHeader:ce(ie("getHeader",X(Ee))),getHeader:ce(ne("data","header",G(Se))),header:ce(ie("read",V(ye))),read:ce(ie("finished",G(ve)),ne("data","read",V(ge))),nextPatch:ce(ie("sendHeader",V((e=>(e.patchNumber=e.patchNumber+1,{...e}))))),finished:ce()},(e=>({...e}))),Ne=[];const Re=(t,n)=>{const i=fe(t,(e=>{i===e&&(console.log("[MachineStore] state",e.machine.current,"context",e.context),r.set({state:e.machine.current,context:e.context}))}),n),r=function(t,n=e){let i;const r=[];function a(e){if(o(t,e)&&(t=e,i)){const e=!Ne.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),Ne.push(n,t)}if(e){for(let e=0;e<Ne.length;e+=2)Ne[e][0](Ne[e+1]);Ne.length=0}}}return{set:a,update:function(e){a(e(t))},subscribe:function(o,c=e){const s=[o,c];return r.push(s),1===r.length&&(i=n(a)||e),o(t),()=>{const e=r.indexOf(s);-1!==e&&r.splice(e,1),0===r.length&&(i(),i=null)}}}}({state:t.current,context:i.context}),a=i.send;return{store:r,send:a,service:i}};class Oe extends EventTarget{constructor(e){super(),this.device=e,this.interfaceNumber=0,this.endpointIn=0,this.endpointOut=0,this.queue=[],this.transferInflight=!1}onReceive(e){}onReceiveError(e){}setEndpoints(){let e=this.device.configuration.interfaces;console.log("Interfaces",this.device.configuration.interfaces),e.forEach((e=>{console.log("Element",e),e.alternates.forEach((t=>{255==t.interfaceClass&&(this.interfaceNumber=e.interfaceNumber,t.endpoints.forEach((e=>{"out"==e.direction&&(this.endpointOut=e.endpointNumber),"in"==e.direction&&(this.endpointIn=e.endpointNumber)})))}))})),0===this.endpointIn&&console.error("endpointIn is 0"),0===this.endpointOut&&console.error("endpointOut is 0")}async connect(){let e=async()=>{try{const t=await this.device.transferIn(this.endpointIn,64);this.onReceive(t.data),e()}catch(e){this.onReceiveError(e)}};try{if(await this.device.open(),null===this.device.configuration)return this.device.selectConfiguration(1);await this.setEndpoints(),console.log("Interface number:",this.interfaceNumber),console.log("Configuration:",this.device.configuration),await this.device.claimInterface(this.interfaceNumber);try{await this.device.selectAlternateInterface(this.interfaceNumber,this.endpointIn)}catch(e){}await this.device.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:1,index:this.interfaceNumber}),e()}catch(e){throw console.error(e),e}}async disconnect(){return this.device.controlTransferOut({requestType:"class",recipient:"interface",request:34,value:0,index:this.interfaceNumber}).then((()=>this.device.close()))}send(e){return console.log("sending",e,this.endpointOut),this.device.transferOut(this.endpointOut,e)}queueMessage(e){if(queue.length>5e3)return console.warn("You have queued too many messages, have more chill");this.queue.push(e)}async processQueue(){if(0===this.queue.length)return;if(this.transferInflight)return;this.transferInflight=!0;const e=this.queue.shift();try{await this.send(e)}catch(t){console.error(t),this.queue.unshift(e)}this.transferInflight=!1}startQueue(){this.stopQueue(),this.queueInterval=setInterval(this.processQueue.bind(this),1)}stopQueue(){this.queueInterval&&clearInterval(this.queueInterval)}}const Ie=[{vendorId:9114},{vendorId:51966}];const Te=["P_PWM","P_DRIVE","P_PITCH","P_OCT","P_GLIDE","P_INTERVAL","P_NOISE","P_MIXRESO","P_ROTATE","P_SCALE","P_MICROTUNE","P_STRIDE","P_SENS","P_A","P_D","P_S","P_R","P_ENV1_UNUSED","P_ENV_LEVEL1","P_A2","P_D2","P_S2","P_R2","P_ENV2_UNUSED","P_DLSEND","P_DLTIME","P_DLRATIO","P_DLWOB","P_DLFB","P_TEMPO","P_RVSEND","P_RVTIME","P_RVSHIM","P_RVWOB","P_RVUNUSED","P_SWING","P_ARPONOFF","P_ARPMODE","P_ARPDIV","P_ARPPROB","P_ARPLEN","P_ARPOCT","P_LATCHONOFF","P_SEQMODE","P_SEQDIV","P_SEQPROB","P_SEQLEN","P_GATE_LENGTH","P_SMP_POS","P_SMP_GRAINSIZE","P_SMP_RATE","P_SMP_TIME","P_SAMPLE","P_SEQPAT","P_JIT_POS","P_JIT_GRAINSIZE","P_JIT_RATE","P_JIT_PULSE","P_JIT_UNUSED","P_SEQSTEP","P_ASCALE","P_AOFFSET","P_ADEPTH","P_AFREQ","P_ASHAPE","P_AWARP","P_BSCALE","P_BOFFSET","P_BDEPTH","P_BFREQ","P_BSHAPE","P_BWARP","P_XSCALE","P_XOFFSET","P_XDEPTH","P_XFREQ","P_XSHAPE","P_XWARP","P_YSCALE","P_YOFFSET","P_YDEPTH","P_YFREQ","P_YSHAPE","P_YWARP","P_MIXSYNTH","P_MIXWETDRY","P_MIXHPF","P_MIX_UNUSED","P_CV_QUANT","P_HEADPHONE","P_MIXINPUT","P_MIXINWETDRY","P_SYS_UNUSED1","P_SYS_UNUSED2","P_SYS_UNUSED3","P_ACCEL_SENS"],De=[{id:"P_PWM",min:-100,max:100,type:"int16",offset:0,cc:13,name:"Shape",description:"Controls the shape of the oscillators in Plinky. When exactly 0%, you get a supersaw: 4 sawtooths per voice. When positive, you blend smoothly through 16 ROM wavetable shapes provided by @miunau. When negative, you get PWM control of pulse/square shapes."},{id:"P_DRIVE",min:-1024,max:1024,cc:4,name:"Drive",description:"Drive/Saturation. When turned up high, the saturation unit will create guitar-like tones, especially when playing polyphonically. It can also be used to compensate for changes in volume, for example if the Sensitivity parameter is low."},{id:"P_PITCH",min:-1024,max:1024,cc:9,name:"Pitch",description:"Use this to (fine) tune plinky. Range is 1 octave up or down, unquantized."},{id:"P_OCT",min:-1024,max:1024,cc:-1,name:"Octave",description:"Use this to quickly change pitch, quantised to octaves."},{id:"P_GLIDE",min:0,max:127,cc:5,name:"Glide",description:"Controls the speed of the portamento between notes in a single voice. Higher = slower"},{id:"P_INTERVAL",min:0,max:127,cc:14,name:"Interval",description:"Each voice has several oscillators, and this sets a fixed interval between them, from +1 to -1 octaves."},{id:"P_NOISE",min:-127,max:127,cc:2,name:"Noise",description:"Each voice can add a variable amount of white noise to the oscillator, before the low-pass gate."},{id:"P_MIXRESO",min:0,max:127,cc:71,name:"Resonance",description:"Each voice has a 2-pole lowpass gate controlled by your finger pressure and the Sensitivity control. This parameter adds resonance to the filter. Note that at high levels of resonance, you may wish to adjust the drive or the high pass filter paramters."},{id:"P_ROTATE",min:0,max:127,cc:-1,name:"Degree",description:"Think of this as a quantized pitch control, that transposes plinky in such a way that all the notes stay in the same scale. In other words, it changes which degree of the scale is played, but not the root of the scale itself."},{id:"P_SCALE",min:0,max:26,cc:-1,name:"Scale",enum_id:["S_MAJOR","S_MINOR","S_HARMMINOR","S_PENTA","S_PENTAMINOR","S_HIRAJOSHI","S_INSEN","S_IWATO","S_MINYO","S_FIFTHS","S_TRIADMAJOR","S_TRIADMINOR","S_DORIAN","S_PHYRGIAN","S_LYDIAN","S_MIXOLYDIAN","S_AEOLIAN","S_LOCRIAN","S_BLUESMINOR","S_BLUESMAJOR","S_ROMANIAN","S_WHOLETONE","S_HARMONICS","S_HEXANY","S_JUST","S_CHROMATIC","S_LAST"],enum_name:["Major","Minor","Harminoc Min","Penta Maj","Penta Min","Hirajoshi","Insen","Iwato","Minyo","Fifths","Triad Maj","Triad Min","Dorian","Phrygian","Lydian","Mixolydian","Aeolian","Locrian","Blues Min","Blues Maj","Romanian","Wholetone","Harmonics","Hexany","Just","Chromatic"],description:"Selects which scale of notes plinky uses"},{id:"P_MICROTUNE",min:0,max:127,cc:-1,name:"Microtune",description:"Controls how much vertical movement of your finger detunes the note. This also thickens the sound through 'unison' detuning of the individual oscillators in each note, so values above 0 are recommended."},{id:"P_STRIDE",min:0,max:127,cc:-1,name:"Stride",description:"Controls the interval, in semitones, between each column of plinky. It defaults to 7 semitones, a perfect fifth, like a Cello or Violin. The notes are always snapped to the chosen scale, even if the stride calls for chromatic notes, so plinky does its best to choose column pitches that follow this stride while staying in-scale."},{id:"P_SENS",min:0,max:1,default:.5,cc:3,name:"Sensitivity",description:"Master sensitivty, controlling the mapping of finger pressure to the opening/closing of each voice's low-pass gate. If you are looking for a lowpass cutoff frequency, this is the parameter you want."},{id:"P_A",min:0,max:127,cc:73,name:"Attack",description:"Attack time for the main envelope that controls the lowpass gate. The peak level is set by the pressure of your finger, modulated by the Sensitivity parameter."},{id:"P_D",min:0,max:127,cc:75,name:"Decay",description:"Decay time for the main envelope that controls the lowpass gate."},{id:"P_S",min:0,max:127,cc:74,name:"Sustain",description:"Sustain level for the main envelope that controls the lowpass gate."},{id:"P_R",min:0,max:127,cc:72,name:"Release",description:"Release time for the main envelope that controls the lowpass gate."},{id:"P_ENV1_UNUSED",min:0,max:127,cc:-1,description:""},{id:"P_ENV_LEVEL",min:0,max:127,cc:19,name:"Env 2 Level",description:"Sets the peak level of the second envelope, which can be used as a modulation source."},{id:"P_A2",min:0,max:127,cc:20,name:"Attack 2",description:"Attack time of the second envelope, which can be used as a modulation source."},{id:"P_D2",min:0,max:127,cc:21,name:"Decay 2",description:"Decay time of the second envelope, which can be used as a modulation source."},{id:"P_S2",min:0,max:127,cc:22,name:"Sustain 2",description:"Sustain level of the second envelope, which can be used as a modulation source."},{id:"P_R2",min:0,max:127,cc:23,name:"Release 2",description:"Release time of the second envelope, which can be used as a modulation source."},{id:"P_ENV2_UNUSED",min:0,max:127,cc:-1,description:""},{id:"P_DLSEND",min:0,max:1,default:0,cc:94,name:"Delay Send",description:"Amount of the dry sound sent to the delay unit. Turn it up for echos!"},{id:"P_DLTIME",min:-1,max:1,default:.375,cc:12,name:"Delay Time",description:"The time between each echo. Positive values are un-quantized; negative values are multiples of the current tempo."},{id:"P_DLRATIO",min:0,max:1,default:1,cc:-1,name:"Delay Ratio",description:"The delay unit is stereo. This moves the right tap to an earlier time, causing ping-pong poly-rhthmic repeats. Try simple ratios like 33%, 50%, 75%."},{id:"P_DLWOB",min:0,max:1,default:.25,name:"Delay Wobble",cc:-1,description:"Amount of simulated tape speed wobble, causing pitch distortions in the delay."},{id:"P_DLFB",min:0,max:1,default:.5,name:"Delay Feedback",cc:95,description:"Amount of feedback - the volume of each echo reduces by this amount."},{id:"P_TEMPO",min:-1,max:1,name:"BPM",remap:"120*Math.pow(2,x)",default:0,cc:-1,description:"Tempo in BPM. You can also tap this parameter pad rhythmically to set the tempo."},{id:"P_RVSEND",min:0,max:1,name:"Reverb Send",default:.25,cc:91,description:"Amount of the dry sound sent to the reverb unit. Turn it up for reverb!"},{id:"P_RVTIME",min:0,max:1,default:.5,name:"Reverb Time",cc:92,description:"Reverb time. controls the length of the decay of the reverb."},{id:"P_RVSHIM",min:0,max:1,default:.25,name:"Shimmer",cc:93,description:"Amount of octave-up signal that is fed into the reverb, causing a shimmer effect."},{id:"P_RVWOB",min:0,max:1,default:.25,name:"Reverb Wobble",cc:-1,description:"Amount of simulated tape speed wobble, causing pitch distortions in the reverb. Avoids metallic artefacts."},{id:"P_RVUNUSED",min:0,max:1,cc:-1,description:""},{id:"P_SWING",min:0,max:1,cc:-1,name:"Swing",description:"OUT OF ORDER. This parameter will be used to add swing in a future firmware update"},{id:"P_ARPONOFF",min:0,max:1,cc:102,default:0,name:"Arp on/off",description:"Switches the arpeggiator on and off."},{id:"P_ARPMODE",cc:103,default:0,min:0,max:15,name:"Arpeggiator Mode",enum_id:["ARP_UP","ARP_DOWN","ARP_UPDOWN","ARP_UPDOWNREP","ARP_PEDALUP","ARP_PEDALDOWN","ARP_PEDALUPDOWN","ARP_RANDOM","ARP_RANDOM2","ARP_ALL","ARP_UP8","ARP_DOWN8","ARP_UPDOWN8","ARP_RANDOM8","ARP_RANDOM28","ARP_LAST"],enum_name:["Up","Down","Up then Down","Up then Down (repeat end notes)","Up with lowest note pedal","Down with lowest note pedal","Up then down with lowest note pedal","Random","Random playing 2 notes at a time","Repeat all notes (polyphonic)","Up (all 8 columns)","Down (all 8 columns)","Up then Down (all 8 columns)","Random (all 8 columns)","Random, 2 notes at a time (all 8 columns)"],description:"Arpeggiator mode. The '8 column' modes include every column, even those without a note, introducing rests into the arpeggio."},{id:"P_ARPDIV",min:-1,max:22,default:.09090909,name:"Arp Clock Divide",enum_id:["1","2","3","4","5","6","8","10","12","16","20","24","32","40","48","64","80","96","128","160","192","256"],enum_name:["1/32","2/32","3/32","4/32","5/32","6/32","8/32","10/32","12/32","16/32","20/32","24/32","32/32","40/32","48/32","64/32","80/32","96/32","128/32","160/32","192/32","256/32"],cc:-1,description:"Sets the speed of the arpeggiator. Negative numbers are un-quantized, positive numbers divide a 32nd note clock."},{id:"P_ARPPROB",min:0,max:1,default:1,cc:-1,name:"Arp Probability / Density",description:"Sets the probability of the apreggiator progressing on each tick of its clock. If the Arp Length parameter is 0, this is a true random probability, otherwise it's the density of a Euclidean rhythm."},{id:"P_ARPLEN",min:-17,max:17,default:8,cc:-1,name:"Arp Pattern Length",description:"When non zero, this sets the length of the euclidean pattern used by the arp. Use the Arp probability parameter to change how many note are included in each pattern. Negative values treat rests differently, try both."},{id:"P_ARPOCT",min:0,max:4,default:0,cc:-1,name:"Arp Octaves",description:"Sets how many octaves the arpeggiator ranges over."},{id:"P_LATCHONOFF",min:0,max:1,name:"Latch on/off",cc:-1,description:"Switches the latch on/off. When on, played notes will sustain even when you take your fingers off plinky. Useful for chords, arps, drones, or using plinky as an oscillator voice."},{id:"P_SEQMODE",min:0,max:6,name:"Sequencer Mode",default:0,enum_id:["SEQ_PAUSE","SEQ_FWD","SEQ_BACK","SEQ_PINGPONG","SEQ_PINGPONGREP","SEQ_RANDOM","SEQ_LAST"],enum_name:["Pause","Forwards","Backwards","Pingpong","Pingpong (repeat end notes)","Random"],cc:-1,description:"Sets the order that notes are played by the sequencer."},{id:"P_SEQDIV",min:0,max:22,default:.27272727,name:"Seq Clock Divide",enum_id:["1","2","3","4","5","6","8","10","12","16","20","24","32","40","48","64","80","96","128","160","192","256"],enum_name:["1/32","2/32","3/32","4/32","5/32","6/32","8/32","10/32","12/32","16/32","20/32","24/32","32/32","40/32","48/32","64/32","80/32","96/32","128/32","160/32","192/32","256/32"],cc:-1,description:"Sets the speed of the sequencer. Negative numbers are un-quantized, positive numbers divide a 32nd note clock."},{id:"P_SEQPROB",min:0,max:1,default:1,cc:-1,name:"Seq Probability / Density",description:"Sets the probability of the sequencer progressing on each tick of its clock. If the Arp Length parameter is 0, this is a true random probability, otherwise it's the density of a Euclidean rhythm."},{id:"P_SEQLEN",min:-17,max:17,default:8,cc:-1,name:"Seq Pattern Length",description:"When non zero, this sets the length of the euclidean pattern used by the sequencer. Use the Seq Probability parameter to change how many note are included in each pattern. Negative values treat rests differently, try both."},{id:"P_GATE_LENGTH",min:0,max:127,cc:11,description:""},{id:"P_SMP_POS",min:0,max:127,cc:15,description:""},{id:"P_SMP_GRAINSIZE",min:0,max:127,cc:16,description:""},{id:"P_SMP_RATE",min:0,max:127,cc:17,description:""},{id:"P_SMP_TIME",min:0,max:127,cc:18,description:""},{id:"P_SAMPLE",min:0,max:127,cc:82,description:""},{id:"P_SEQPAT",min:0,max:127,cc:83,description:""},{id:"P_JIT_POS",min:0,max:127,cc:-1,description:""},{id:"P_JIT_GRAINSIZE",min:0,max:127,cc:-1,description:""},{id:"P_JIT_RATE",min:0,max:127,cc:-1,description:""},{id:"P_JIT_PULSE",min:0,max:127,cc:-1,description:""},{id:"P_JIT_UNUSED",min:0,max:127,cc:-1,description:""},{id:"P_SEQSTEP",min:0,max:127,cc:85,description:""},{id:"P_ASCALE",min:0,max:127,cc:-1,description:""},{id:"P_AOFFSET",min:0,max:127,cc:24,description:""},{id:"P_ADEPTH",min:0,max:127,cc:25,description:""},{id:"P_AFREQ",min:0,max:127,cc:26,description:""},{id:"P_ASHAPE",min:0,max:127,cc:-1,description:""},{id:"P_AWARP",min:0,max:127,cc:-1,description:""},{id:"P_BSCALE",min:0,max:127,cc:-1,description:""},{id:"P_BOFFSET",min:0,max:127,cc:27,description:""},{id:"P_BDEPTH",min:0,max:127,cc:28,description:""},{id:"P_BFREQ",min:0,max:127,cc:29,description:""},{id:"P_BSHAPE",min:0,max:127,cc:-1,description:""},{id:"P_BWARP",min:0,max:127,cc:-1,description:""},{id:"P_XSCALE",min:0,max:127,cc:-1,description:""},{id:"P_XOFFSET",min:0,max:127,cc:78,description:""},{id:"P_XDEPTH",min:0,max:127,cc:77,description:""},{id:"P_XFREQ",min:0,max:127,cc:76,description:""},{id:"P_XSHAPE",min:0,max:127,cc:-1,description:""},{id:"P_XWARP",min:0,max:127,cc:-1,description:""},{id:"P_YSCALE",min:0,max:127,cc:-1,description:""},{id:"P_YOFFSET",min:0,max:127,cc:81,description:""},{id:"P_YDEPTH",min:0,max:127,cc:80,description:""},{id:"P_YFREQ",min:0,max:127,cc:79,description:""},{id:"P_YSHAPE",min:0,max:127,cc:-1,description:""},{id:"P_YWARP",min:0,max:127,cc:-1,description:""},{id:"P_MIXSYNTH",min:0,max:127,cc:7,description:""},{id:"P_MIXWETDRY",min:0,max:127,cc:8,description:""},{id:"P_MIXHPF",min:0,max:127,cc:21,description:""},{id:"P_MIX_UNUSED",min:0,max:127,cc:-1,description:""},{id:"P_CV_QUANT",min:0,max:127,cc:-1,description:""},{id:"P_HEADPHONE",min:0,max:127,cc:-1,description:""},{id:"P_MIXINPUT",min:0,max:127,cc:89,description:""},{id:"P_MIXINWETDRY",min:0,max:127,cc:90,description:""},{id:"P_SYS_UNUSED1",min:0,max:127,cc:-1,description:""},{id:"P_SYS_UNUSED2",min:0,max:127,cc:-1,description:""},{id:"P_SYS_UNUSED3",min:0,max:127,cc:-1,description:""},{id:"P_SYS_UNUSED4",min:0,max:127,cc:-1,description:""}];function Le(e){let t={arp:!1,latch:!1,loopStart:0,loopLength:8,params:[]};Te.forEach(((n,i)=>{const r=16*i,o=e.slice(r,16*i+16),a=new Int16Array(o),c=(s=n,console.log(De),De.find((e=>e.id===s))||{name:n});var s;t.params.push({id:n,name:c.name,description:c.description,buffer:o,value:a[0],enum:null,mods:{env:a[1],pressure:a[2],a:a[3],b:a[4],x:a[5],y:a[6],random:a[7]}})}));const n=e.slice(e.byteLength-16,e.byteLength);return t.arp=(1&new Uint8Array(n)[0])>0,t.latch=(2&new Uint8Array(n)[0])>0,t.loopStart=new Int8Array(n)[1],t.loopLength=new Int8Array(n)[2],console.log("bitfield",n,t),t}class Ue extends Oe{onReceive(e){console.log("Port data:",e.buffer);const{service:t}=Ce;t.child?t.child.send({type:"data",data:e.buffer}):t.send({type:"data",data:e.buffer})}onReceiveError(e){console.error("Port error:",e);const{service:t}=Ce;t.child?t.child.send({type:"error",data:e}):t.send({type:"error",data:e})}}async function Me(e){try{return e.port=await class{constructor(){}static async getPorts(e){return navigator.usb.getDevices().then((t=>t.map((t=>e?new e(t):new Port(t)))))}static async requestPort(e){return navigator.usb.requestDevice({filters:Ie}).then((t=>new e?new e(t):new Port(t)))}}.requestPort(Ue),await e.port.connect(),e}catch(e){throw e}}const Ce=function(e={}){const t=he({disconnected:ce(ne("connect","connecting"),ne("parsePatch","disconnected",V(((e,t)=>{if(t.patch){const n=t.patch,i=n.buffer.slice(n.byteOffset,n.byteLength+n.byteOffset),r=Le(i);return{...e,patchJSON:r,patch:i}}return{...e}})))),connecting:le(Me,ne("done","connected"),ne("error","error",V(((e,t)=>({...e,error:t.error}))))),connected:ce(ne("loadPatch","loadPatch",V(((e,t)=>({...e,patchNumber:t.patchNumber})))),ne("savePatch","savePatch"),ne("clearPatch","clearPatch"),ne("error","error",V(((e,t)=>({...e,error:t.error}))))),clearPatch:ce(ie("connected",V((e=>(e.patch=null,e.patchJSON={},{...e}))))),loadPatch:le(Ae,ne("done","connected",V(((e,t)=>{const n=Uint8Array.from(Array.prototype.concat(...t.data.result.map((e=>Array.from(e))))),i=n.buffer.slice(n.byteOffset,n.byteLength+n.byteOffset);return{...e,patch:i,patchJSON:Le(i)}}))),ne("error","error",V(((e,t)=>({...e,error:t.error}))))),savePatch:le(xe,ne("done","connected"),ne("error","error",V(((e,t)=>({...e,error:t.error}))))),loadBank:le(we,ne("done","connected",V(((e,t)=>{const n=Uint8Array.from(Array.prototype.concat(...t.data.result.map((e=>Array.from(e))))),i=n.buffer.slice(n.byteOffset,n.byteLength+n.byteOffset);return{...e,patch:i,patchJSON:Le(i)}}))),ne("error","error",V(((e,t)=>({...e,error:t.error}))))),error:ce(ne("connect","connecting",V((e=>(e.error=null,{...e})))))},(e=>({...e}))),n=Array(32).fill().map(((e,t)=>({number:t,path:null})));return Re(t,Object.assign(e,{port:null,patch:null,bank:n,patchJSON:{}}))}({patchNumber:0});function qe(e,t,n){const i=e.slice();return i[20]=t[n],i}function ke(e){let t,n,i=e[0].context.error+"";return{c(){t=l("p"),n=u(i),p(t,"class","error")},m(e,i){s(e,t,i),c(t,n)},p(e,t){1&t&&i!==(i=e[0].context.error+"")&&P(n,i)},d(e){e&&d(t)}}}function He(e){let t;return{c(){t=l("p"),t.innerHTML='You need the 0.9l firmware (or newer) to use this!<br/><a href="https://plinkysynth.com/firmware">Download here!</a>'},m(e,n){s(e,t,n)},d(e){e&&d(t)}}}function $e(t){let n;return{c(){n=l("p"),n.textContent="No patch in browser memory"},m(e,t){s(e,n,t)},p:e,d(e){e&&d(n)}}}function Fe(e){let t,n,i,r,o,a,f,_,b,y,S,g,v,E,A,x,w,N,R,O,I,T,D,L,U,M,C,q,k,H,$,F,W,z,B=e[0].context.patch.byteLength+"",Q=e[0].context.patchJSON.arp+"",Y=e[0].context.patchJSON.latch+"",J=e[0].context.patchJSON.loopStart+"",V=e[0].context.patchJSON.loopLength+"",X=e[0].context.patchJSON.params,j=[];for(let t=0;t<X.length;t+=1)j[t]=We(qe(e,X,t));return{c(){t=l("p"),t.textContent="This is the patch that has been loaded into the browser's memory.",n=h(),i=l("button"),i.textContent="Clear patch in browser memory",r=h(),o=l("p"),a=u("Loaded: "),f=u(B),_=u(" bytes"),b=h(),y=l("h3"),y.textContent="Link to patch",S=h(),g=l("label"),g.textContent="Link:",v=h(),E=l("input"),A=h(),x=l("h3"),x.textContent="Params",w=h(),N=l("p"),R=u("Arp: "),O=u(Q),I=l("br"),T=u("\n\t\t\tLatch: "),D=u(Y),L=l("br"),U=u("\n\t\t\tLoop start: "),M=u(J),C=l("br"),q=u("\n\t\t\tLoop length: "),k=u(V),H=l("br"),$=h(),F=l("ul");for(let e=0;e<j.length;e+=1)j[e].c();p(i,"class","svelte-1rz8qbw"),p(g,"for","i-link-url"),p(E,"class","link svelte-1rz8qbw"),E.value=e[4],p(E,"id","i-link-url"),p(F,"class","params svelte-1rz8qbw")},m(d,l){s(d,t,l),s(d,n,l),s(d,i,l),s(d,r,l),s(d,o,l),c(o,a),c(o,f),c(o,_),s(d,b,l),s(d,y,l),s(d,S,l),s(d,g,l),s(d,v,l),s(d,E,l),s(d,A,l),s(d,x,l),s(d,w,l),s(d,N,l),c(N,R),c(N,O),c(N,I),c(N,T),c(N,D),c(N,L),c(N,U),c(N,M),c(N,C),c(N,q),c(N,k),c(N,H),s(d,$,l),s(d,F,l);for(let e=0;e<j.length;e+=1)j[e].m(F,null);var u;W||(z=m(i,"click",(u=e[9],function(e){return e.preventDefault(),u.call(this,e)})),W=!0)},p(e,t){if(1&t&&B!==(B=e[0].context.patch.byteLength+"")&&P(f,B),16&t&&E.value!==e[4]&&(E.value=e[4]),1&t&&Q!==(Q=e[0].context.patchJSON.arp+"")&&P(O,Q),1&t&&Y!==(Y=e[0].context.patchJSON.latch+"")&&P(D,Y),1&t&&J!==(J=e[0].context.patchJSON.loopStart+"")&&P(M,J),1&t&&V!==(V=e[0].context.patchJSON.loopLength+"")&&P(k,V),1025&t){let n;for(X=e[0].context.patchJSON.params,n=0;n<X.length;n+=1){const i=qe(e,X,n);j[n]?j[n].p(i,t):(j[n]=We(i),j[n].c(),j[n].m(F,null))}for(;n<j.length;n+=1)j[n].d(1);j.length=X.length}},d(e){e&&d(t),e&&d(n),e&&d(i),e&&d(r),e&&d(o),e&&d(b),e&&d(y),e&&d(S),e&&d(g),e&&d(v),e&&d(E),e&&d(A),e&&d(x),e&&d(w),e&&d(N),e&&d($),e&&d(F),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(j,e),W=!1,z()}}}function We(e){let t,n,i,r,o,a,m,f,_,b,y,S,g,v,E,A,x,w,N,R,O,I,T,D,L,U,M,C,q,k,H,$,F,W,z,B,Q,Y,J,V,X,j,G,Z,K,ee,te,ne,ie,re,oe,ae,ce,se,de,le,ue,he,me,pe,fe,Pe,_e,be,ye,Se,ge,ve,Ee,Ae,xe,we,Ne,Re,Oe,Ie,Te,De,Le,Ue,Me,Ce,qe,ke,He,$e,Fe,We,ze=e[20].name+"",Ye=e[20].id+"",Je=e[20].value+"",Ve=Array.from(new Uint8Array(e[20].buffer)).map(Qe)+"",Xe=new Uint8Array(e[20].buffer).toString()+"",je=Be(e[10](e[20].value))+"",Ge=Be(e[10](e[20].mods.env))+"",Ze=Be(e[10](e[20].mods.pressure))+"",Ke=Be(e[10](e[20].mods.a))+"",et=Be(e[10](e[20].mods.b))+"",tt=Be(e[10](e[20].mods.x))+"",nt=Be(e[10](e[20].mods.y))+"",it=Be(e[10](e[20].mods.random))+"",rt=e[20].description+"";return{c(){t=l("li"),n=l("h3"),i=u(ze),r=h(),o=l("code"),a=u("id: "),m=u(Ye),f=l("br"),_=u("\n\t\t\t\t\t\tval "),b=u(Je),y=l("br"),S=u("\n\t\t\t\t\t\thex "),g=u(Ve),v=l("br"),E=u("\n\t\t\t\t\t\tdec "),A=u(Xe),x=h(),w=l("div"),N=l("table"),R=l("tr"),O=l("td"),O.textContent="Base",I=h(),T=l("td"),D=u(je),L=u("%"),U=l("br"),M=h(),C=l("tr"),q=l("td"),q.textContent="Env",k=h(),H=l("td"),$=u(Ge),F=u("%"),W=l("br"),z=h(),B=l("tr"),Q=l("td"),Q.textContent="Pressure",Y=h(),J=l("td"),V=u(Ze),X=u("%"),j=l("br"),G=h(),Z=l("tr"),K=l("td"),K.textContent="A",ee=h(),te=l("td"),ne=u(Ke),ie=u("%"),re=l("br"),oe=h(),ae=l("table"),ce=l("tr"),se=l("td"),se.textContent="B",de=h(),le=l("td"),ue=u(et),he=u("%"),me=l("br"),pe=h(),fe=l("tr"),Pe=l("td"),Pe.textContent="X",_e=h(),be=l("td"),ye=u(tt),Se=u("%"),ge=l("br"),ve=h(),Ee=l("tr"),Ae=l("td"),Ae.textContent="Y",xe=h(),we=l("td"),Ne=u(nt),Re=u("%"),Oe=l("br"),Ie=h(),Te=l("tr"),De=l("td"),De.textContent="Random",Le=h(),Ue=l("td"),Me=u(it),Ce=u("%"),qe=l("br"),ke=h(),He=l("div"),$e=l("p"),Fe=u(rt),We=h(),p(n,"class","svelte-1rz8qbw"),p(o,"class","svelte-1rz8qbw"),p(O,"class","svelte-1rz8qbw"),p(T,"class","svelte-1rz8qbw"),p(q,"class","svelte-1rz8qbw"),p(H,"class","svelte-1rz8qbw"),p(Q,"class","svelte-1rz8qbw"),p(J,"class","svelte-1rz8qbw"),p(K,"class","svelte-1rz8qbw"),p(te,"class","svelte-1rz8qbw"),p(N,"class","svelte-1rz8qbw"),p(se,"class","svelte-1rz8qbw"),p(le,"class","svelte-1rz8qbw"),p(Pe,"class","svelte-1rz8qbw"),p(be,"class","svelte-1rz8qbw"),p(Ae,"class","svelte-1rz8qbw"),p(we,"class","svelte-1rz8qbw"),p(De,"class","svelte-1rz8qbw"),p(Ue,"class","svelte-1rz8qbw"),p(ae,"class","svelte-1rz8qbw"),p(w,"class","mods svelte-1rz8qbw"),p($e,"class","svelte-1rz8qbw"),p(He,"class","description svelte-1rz8qbw"),p(t,"class","svelte-1rz8qbw")},m(e,d){s(e,t,d),c(t,n),c(n,i),c(t,r),c(t,o),c(o,a),c(o,m),c(o,f),c(o,_),c(o,b),c(o,y),c(o,S),c(o,g),c(o,v),c(o,E),c(o,A),c(t,x),c(t,w),c(w,N),c(N,R),c(R,O),c(R,I),c(R,T),c(T,D),c(T,L),c(T,U),c(N,M),c(N,C),c(C,q),c(C,k),c(C,H),c(H,$),c(H,F),c(H,W),c(N,z),c(N,B),c(B,Q),c(B,Y),c(B,J),c(J,V),c(J,X),c(J,j),c(N,G),c(N,Z),c(Z,K),c(Z,ee),c(Z,te),c(te,ne),c(te,ie),c(te,re),c(w,oe),c(w,ae),c(ae,ce),c(ce,se),c(ce,de),c(ce,le),c(le,ue),c(le,he),c(le,me),c(ae,pe),c(ae,fe),c(fe,Pe),c(fe,_e),c(fe,be),c(be,ye),c(be,Se),c(be,ge),c(ae,ve),c(ae,Ee),c(Ee,Ae),c(Ee,xe),c(Ee,we),c(we,Ne),c(we,Re),c(we,Oe),c(ae,Ie),c(ae,Te),c(Te,De),c(Te,Le),c(Te,Ue),c(Ue,Me),c(Ue,Ce),c(Ue,qe),c(t,ke),c(t,He),c(He,$e),c($e,Fe),c(t,We)},p(e,t){1&t&&ze!==(ze=e[20].name+"")&&P(i,ze),1&t&&Ye!==(Ye=e[20].id+"")&&P(m,Ye),1&t&&Je!==(Je=e[20].value+"")&&P(b,Je),1&t&&Ve!==(Ve=Array.from(new Uint8Array(e[20].buffer)).map(Qe)+"")&&P(g,Ve),1&t&&Xe!==(Xe=new Uint8Array(e[20].buffer).toString()+"")&&P(A,Xe),1&t&&je!==(je=Be(e[10](e[20].value))+"")&&P(D,je),1&t&&Ge!==(Ge=Be(e[10](e[20].mods.env))+"")&&P($,Ge),1&t&&Ze!==(Ze=Be(e[10](e[20].mods.pressure))+"")&&P(V,Ze),1&t&&Ke!==(Ke=Be(e[10](e[20].mods.a))+"")&&P(ne,Ke),1&t&&et!==(et=Be(e[10](e[20].mods.b))+"")&&P(ue,et),1&t&&tt!==(tt=Be(e[10](e[20].mods.x))+"")&&P(ye,tt),1&t&&nt!==(nt=Be(e[10](e[20].mods.y))+"")&&P(Ne,nt),1&t&&it!==(it=Be(e[10](e[20].mods.random))+"")&&P(Me,it),1&t&&rt!==(rt=e[20].description+"")&&P(Fe,rt)},d(e){e&&d(t)}}}function ze(t){let n,r,o,a,y,S,g,v,E,A,x,w,N,R,O,I,T,D,L,U,M,C,q,k,H,$,F,W,z,B,Q,Y=t[0].state+"",J=t[3]&&ke(t),V=!t[1]&&He();function X(e,t){return e[0].context.patch?Fe:$e}let j=X(t),G=j(t);return{c(){n=l("main"),r=l("h1"),r.textContent="Plinky WebUSB playground",o=h(),a=l("h2"),y=u("Current state: "),S=u(Y),g=h(),J&&J.c(),v=h(),V&&V.c(),E=h(),A=l("button"),x=u("Connect"),w=h(),N=l("div"),R=l("h2"),R.textContent="Patch",O=h(),I=l("p"),I.textContent="Per-patch operations - you can load and save patches on the device.",T=h(),D=l("label"),D.textContent="Patch number (zero index, 0-31)",L=h(),U=l("input"),M=h(),C=l("button"),q=u("Load patch"),k=h(),H=l("button"),$=u("Save patch"),F=h(),W=l("h2"),W.textContent="Current patch",z=h(),G.c(),p(r,"class","svelte-1rz8qbw"),b(A,"display",t[1]?"none":"block"),p(A,"class","svelte-1rz8qbw"),p(D,"for","i-patch-number"),p(U,"min","0"),p(U,"max","32"),p(U,"type","number"),U.disabled=t[2],p(U,"id","i-patch-number"),C.disabled=t[2],p(C,"class","svelte-1rz8qbw"),H.disabled=t[2],p(H,"class","svelte-1rz8qbw"),b(N,"display",t[1]?"block":"none"),p(n,"class","svelte-1rz8qbw")},m(e,i){s(e,n,i),c(n,r),c(n,o),c(n,a),c(a,y),c(a,S),c(n,g),J&&J.m(n,null),c(n,v),V&&V.m(n,null),c(n,E),c(n,A),c(A,x),c(n,w),c(n,N),c(N,R),c(N,O),c(N,I),c(N,T),c(N,D),c(N,L),c(N,U),_(U,t[0].context.patchNumber),c(N,M),c(N,C),c(C,q),c(N,k),c(N,H),c(H,$),c(n,F),c(n,W),c(n,z),G.m(n,null),B||(Q=[m(A,"click",t[6]),m(U,"input",t[11]),m(C,"click",t[7]),m(H,"click",t[8])],B=!0)},p(e,[t]){1&t&&Y!==(Y=e[0].state+"")&&P(S,Y),e[3]?J?J.p(e,t):(J=ke(e),J.c(),J.m(n,v)):J&&(J.d(1),J=null),e[1]?V&&(V.d(1),V=null):V||(V=He(),V.c(),V.m(n,E)),2&t&&b(A,"display",e[1]?"none":"block"),4&t&&(U.disabled=e[2]),1&t&&f(U.value)!==e[0].context.patchNumber&&_(U,e[0].context.patchNumber),4&t&&(C.disabled=e[2]),4&t&&(H.disabled=e[2]),2&t&&b(N,"display",e[1]?"block":"none"),j===(j=X(e))&&G?G.p(e,t):(G.d(1),G=j(e),G&&(G.c(),G.m(n,null)))},i:e,o:e,d(e){e&&d(n),J&&J.d(),V&&V.d(),G.d(),B=!1,i(Q)}}}function Be(e){return Math.round(100*e+Number.EPSILON)/100}const Qe=e=>e.toString(16);function Ye(e,t,n){let i,r,o,c,s;const{store:d,send:l,service:u}=Ce;a(e,d,(e=>n(0,s=e))),g((()=>{let e=new URL(document.location).searchParams.get("p");if(e){const i=(n=decodeURIComponent(e),t=n.split("").map(((e,t,n)=>t%2?void 0:new Array(2+parseInt(n[t+1],36)).join(e))).join(""),Uint8Array.from(atob(t),be));console.log("patch: ",e,i),l({type:"parsePatch",patch:i})}var t,n}));return e.$$.update=()=>{1&e.$$.dirty&&n(1,i=["connected","loadPatch","savePatch"].indexOf(s.state)>-1),1&e.$$.dirty&&n(2,r=["loadPatch","savePatch"].indexOf(s.state)>-1),1&e.$$.dirty&&n(3,o=["error"].indexOf(s.state)>-1),1&e.$$.dirty&&n(4,c=location.protocol+"//"+location.host+location.pathname+"?p="+encodeURIComponent((e=>{const t=[];for(let n=0,{length:i}=e;n<i;n++)t.push(_e(e[n]));return btoa(t.join(""))})(new Uint8Array(s.context.patch)).split("").reduce(((e,t)=>(e[e.length-2]===t&&e[e.length-1]<35?e[e.length-1]++:e.push(t,0),e)),[]).map((e=>"number"==typeof e?e.toString(36):e)).join("")))},[s,i,r,o,c,d,async function(){l("connect")},function(){l({type:"loadPatch",patchNumber:s.context.patchNumber})},function(){l({type:"savePatch",patchNumber:s.context.patchNumber})},function(){const e=window.location.toString();e.indexOf("?")>0&&window.history.replaceState({},document.title,e.substring(0,e.indexOf("?"))),l({type:"clearPatch"})},function(e){return(e- -1024)/2048*200-100},function(){s.context.patchNumber=f(this.value),d.set(s)}]}return new class extends class{$destroy(){!function(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}{constructor(e){super(),M(this,e,Ye,ze,o,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
